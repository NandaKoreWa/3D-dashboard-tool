<div class="container" ondragstart="dropItLikeItsHot($event)">
  <!-- {{encargo |json}} -->
  <div class="row">
    <div class="col-12 ">
      <div class="d-flex" *ngFor="let fichero of ficherosNuevos">
        <div class="mx-3">
          <label for="nombrePieza" class="form-label">Nombre</label>
          <input [(ngModel)]="fichero.nombre" type="text" class="form-control" id="nombrePieza"
            placeholder="Nombre Pieza">
        </div>
        <div class="mx-3">
          <label for="horas" class="form-label">Horas</label>
          <input [(ngModel)]="fichero.horas" type="number" class="form-control" id="horas" placeholder="h">
        </div>
        <div class="mx-3">
          <label for="gramos" class="form-label">Gramos</label>
          <input [(ngModel)]="fichero.gramos" type="number" class="form-control" id="gramos" placeholder="gr">
        </div>
        <div class="mx-3" *ngIf="materiales">
          <label for="horas" class="form-label">Horas</label>{{fichero.material|json}}
          <select [(ngModel)]="fichero.material" class="form-select" aria-label="Default select example">
            <option *ngFor="let material of materiales" [value]="material.id">{{material.nombre}}</option>
          </select>
        </div>
      </div>
      <div class="d-flex">
        <div class="mb-3">
          <label for="formFileMultiple" class="form-label">Multiple files input example</label>
          <input accept=".gcode" (change)="file_changed($event)" class="form-control" type="file" id="formFileMultiple"
            multiple>
        </div>
      </div>

    </div>

    <div class="col-2">
      <button type="button" [disabled]="!ficherosNuevos.length" (click)="addPiezas()"
        class="btn btn-success">Añadir</button>
    </div>
  </div>


  <div class="row">
    <div class="col-8" *ngIf="encargo">
      <h3>Piezas</h3>
      <table class="table table-striped">
        <caption></caption>
        <thead>
          <tr>
            <th scope="col">Nombre</th>
            <th scope="col">Material</th>
            <th scope="col">Estado</th>
            <th scope="col">horas</th>
            <th scope="col">Gramos</th>
            <th scope="col">Precio Material</th>
            <th scope="col">Precio Pieza</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pieza of encargo.piezas">
            <td>{{pieza.nombre}}</td>
            <td>{{pieza.material.nombre}}</td>
            <td>{{estados[pieza.estado]}}</td>
            <td>{{pieza.horas}} h</td>
            <td>{{pieza.gramos}} gr</td>
            <td>{{(pieza.material.precioKg / 1000) * pieza.gramos|number :"0.0-2"}} €</td>
            <td>{{calculoPrecioPieza(pieza)|number: "0.0-2"}}€</td>
          </tr>
          <tr>
            <th scope="col">Total</th>
            <td></td>
            <td></td>
            <td>{{totalHoras()|number :"0.0-2"}} h</td>
            <td>{{totalGramos()|number :"0.0-2"}} gr</td>
            <td>{{totalPrecioPieza()|number :"0.0-2"}} €</td>
            <td>{{totalPrecio()|number :"0.0-2"}} €</td>
          </tr>

        </tbody>
      </table>
    </div>
    <div class="col-4" *ngIf="encargo">
      <h3>Gastos Adicionales</h3>
      <table class="table">
        <caption></caption>
        <tbody>
          <tr *ngFor="let gasto of encargo.gastosAdicionales">
            <th>{{gasto.nombre}}</th>
            <th>{{gasto.precio}}</th>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Nueva Pieza</h1>
      </div>

    </div>
  </div>
</div>
